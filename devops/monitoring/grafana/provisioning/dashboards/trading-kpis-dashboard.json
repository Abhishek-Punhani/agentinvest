{
  "annotations": {"list": []},
  "description": "Trading System KPIs - Trade execution, pipelines, and worker health",
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "liveNow": true,
  "panels": [
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 0},
      "id": 100,
      "panels": [],
      "title": "üìä Trade Execution Overview",
      "type": "row"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "P99 trade execution latency from trading tasks",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "mappings": [],
          "max": 10,
          "min": 0,
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "yellow", "value": 1}, {"color": "red", "value": 3}]},
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {"h": 5, "w": 6, "x": 0, "y": 1},
      "id": 1,
      "options": {
        "orientation": "auto",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showThresholdLabels": false,
        "showThresholdMarkers": true
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "histogram_quantile(0.99, sum(rate(celery_task_runtime_bucket{name=~\"pipeline.*|alpha.*|portfolio.*\"}[5m])) by (le))",
          "legendFormat": "P99",
          "refId": "A"
        }
      ],
      "title": "‚è±Ô∏è P99 Trade Latency",
      "type": "gauge"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "Trade task success rate",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {"mode": "absolute", "steps": [{"color": "red", "value": null}, {"color": "yellow", "value": 95}, {"color": "green", "value": 99}]},
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {"h": 5, "w": 6, "x": 6, "y": 1},
      "id": 2,
      "options": {
        "orientation": "auto",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showThresholdLabels": false,
        "showThresholdMarkers": true
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "(sum(celery_task_succeeded_total{name=~\"pipeline.*|alpha.*|portfolio.*\"}) / (sum(celery_task_succeeded_total{name=~\"pipeline.*|alpha.*|portfolio.*\"}) + sum(celery_task_failed_total{name=~\"pipeline.*|alpha.*|portfolio.*\"}) + 0.001)) * 100",
          "legendFormat": "Success %",
          "refId": "A"
        }
      ],
      "title": "üéØ Trade Success Rate",
      "type": "gauge"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "Tasks in critical trading queues",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "mappings": [],
          "min": 0,
          "max": 50,
          "thresholds": {"mode": "absolute", "steps": [{"color": "#73BF69", "value": null}, {"color": "#FADE2A", "value": 5}, {"color": "#FF9830", "value": 15}, {"color": "#F2495C", "value": 30}]}
        },
        "overrides": [
          {"matcher": {"id": "byName", "options": "Trading"}, "properties": [{"id": "displayName", "value": "üî• Trading"}]},
          {"matcher": {"id": "byName", "options": "Orders"}, "properties": [{"id": "displayName", "value": "üìã Orders"}]},
          {"matcher": {"id": "byName", "options": "Risk"}, "properties": [{"id": "displayName", "value": "‚ö†Ô∏è Risk"}]}
        ]
      },
      "gridPos": {"h": 5, "w": 6, "x": 12, "y": 1},
      "id": 3,
      "options": {
        "displayMode": "lcd",
        "minVizHeight": 16,
        "minVizWidth": 8,
        "namePlacement": "left",
        "orientation": "horizontal",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showUnfilled": true,
        "sizing": "auto",
        "valueMode": "color"
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "celery_queue_length{queue_name=\"trading\"} or vector(0)",
          "legendFormat": "Trading",
          "refId": "A"
        },
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "celery_queue_length{queue_name=\"orders\"} or vector(0)",
          "legendFormat": "Orders",
          "refId": "B"
        },
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "celery_queue_length{queue_name=\"risk\"} or vector(0)",
          "legendFormat": "Risk",
          "refId": "C"
        }
      ],
      "title": "üì¨ Queue Depth",
      "type": "bargauge"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "Trade tasks throughput",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "blue", "value": null}]},
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {"h": 5, "w": 6, "x": 18, "y": 1},
      "id": 4,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "textMode": "value_and_name"
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "sum(rate(celery_task_succeeded_total{name=~\"pipeline.*|alpha.*|portfolio.*\"}[5m])) * 60 or vector(0)",
          "legendFormat": "Tasks/min",
          "refId": "A"
        }
      ],
      "title": "üìà Trade Throughput",
      "type": "stat"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "Trade execution latency over time by strategy",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "axisCenteredZero": false,
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "opacity",
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {"group": "A", "mode": "none"},
            "thresholdsStyle": {"mode": "line"}
          },
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "yellow", "value": 2}, {"color": "red", "value": 5}]},
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {"h": 7, "w": 12, "x": 0, "y": 6},
      "id": 5,
      "options": {
        "legend": {"calcs": ["mean", "max", "lastNotNull"], "displayMode": "table", "placement": "right", "showLegend": true},
        "tooltip": {"mode": "multi", "sort": "desc"}
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "histogram_quantile(0.95, sum(rate(celery_task_runtime_bucket{name=~\"pipeline.*|alpha.*|portfolio.*\"}[5m])) by (le, name))",
          "legendFormat": "P95 {{name}}",
          "refId": "A"
        },
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "celery_task_runtime_sum{name=~\"pipeline.*|alpha.*|portfolio.*\"} / celery_task_runtime_count{name=~\"pipeline.*|alpha.*|portfolio.*\"}",
          "legendFormat": "Avg {{name}}",
          "refId": "B"
        }
      ],
      "title": "‚è±Ô∏è Trade Latency by Strategy",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "Trades by status (last 15m)",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "axisCenteredZero": false,
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 80,
            "gradientMode": "hue",
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {"group": "A", "mode": "normal"}
          },
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]},
          "unit": "short"
        },
        "overrides": [
          {"matcher": {"id": "byRegexp", "options": ".*success.*|.*Success.*"}, "properties": [{"id": "color", "value": {"fixedColor": "green", "mode": "fixed"}}]},
          {"matcher": {"id": "byRegexp", "options": ".*fail.*|.*Fail.*|.*error.*"}, "properties": [{"id": "color", "value": {"fixedColor": "red", "mode": "fixed"}}]}
        ]
      },
      "gridPos": {"h": 7, "w": 12, "x": 12, "y": 6},
      "id": 6,
      "options": {
        "legend": {"calcs": ["sum"], "displayMode": "table", "placement": "right", "showLegend": true},
        "tooltip": {"mode": "multi", "sort": "desc"}
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "sum(increase(celery_task_succeeded_total{name=~\"pipeline.*|alpha.*|portfolio.*\"}[15m]))",
          "legendFormat": "Success",
          "refId": "A"
        },
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "sum(increase(celery_task_failed_total{name=~\"pipeline.*|alpha.*|portfolio.*\"}[15m]))",
          "legendFormat": "Failed",
          "refId": "B"
        }
      ],
      "title": "üìä Trades by Status (15m)",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 13},
      "id": 101,
      "panels": [],
      "title": "üîÑ Pipeline & Queue Health",
      "type": "row"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "All queue depths",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "yellow", "value": 10}, {"color": "red", "value": 30}]}
        },
        "overrides": []
      },
      "gridPos": {"h": 7, "w": 8, "x": 0, "y": 14},
      "id": 7,
      "options": {
        "displayMode": "gradient",
        "minVizHeight": 10,
        "minVizWidth": 0,
        "orientation": "horizontal",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showUnfilled": true,
        "valueMode": "color"
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "celery_queue_length",
          "legendFormat": "{{queue_name}}",
          "refId": "A"
        }
      ],
      "title": "üì¨ All Queue Depths",
      "type": "bargauge"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "Pipeline runs and failures (15m window)",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "axisCenteredZero": false,
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 70,
            "gradientMode": "opacity",
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {"group": "A", "mode": "none"}
          },
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}
        },
        "overrides": [
          {"matcher": {"id": "byRegexp", "options": ".*success.*|.*Success.*"}, "properties": [{"id": "color", "value": {"fixedColor": "green", "mode": "fixed"}}]},
          {"matcher": {"id": "byRegexp", "options": ".*fail.*|.*Fail.*|.*error.*"}, "properties": [{"id": "color", "value": {"fixedColor": "red", "mode": "fixed"}}]}
        ]
      },
      "gridPos": {"h": 7, "w": 8, "x": 8, "y": 14},
      "id": 8,
      "options": {
        "legend": {"calcs": ["sum", "lastNotNull"], "displayMode": "table", "placement": "right", "showLegend": true},
        "tooltip": {"mode": "multi", "sort": "desc"}
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "sum(increase(celery_task_succeeded_total{name=~\"pipeline.*\"}[15m])) by (name)",
          "legendFormat": "{{name}} Success",
          "refId": "A"
        },
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "sum(increase(celery_task_failed_total{name=~\"pipeline.*\"}[15m])) by (name)",
          "legendFormat": "{{name}} Failed",
          "refId": "B"
        }
      ],
      "title": "üîÑ Pipeline Runs (15m)",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "Pipeline duration percentiles",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "axisCenteredZero": false,
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "opacity",
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {"group": "A", "mode": "none"},
            "thresholdsStyle": {"mode": "line"}
          },
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "yellow", "value": 300}, {"color": "red", "value": 600}]},
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {"h": 7, "w": 8, "x": 16, "y": 14},
      "id": 9,
      "options": {
        "legend": {"calcs": ["mean", "max"], "displayMode": "table", "placement": "right", "showLegend": true},
        "tooltip": {"mode": "multi", "sort": "desc"}
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "histogram_quantile(0.95, sum(rate(celery_task_runtime_bucket{name=~\"pipeline.*\"}[15m])) by (le, name))",
          "legendFormat": "P95 {{name}}",
          "refId": "A"
        }
      ],
      "title": "‚è±Ô∏è Pipeline Duration (P95)",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 21},
      "id": 102,
      "panels": [],
      "title": "üíª Worker Resources",
      "type": "row"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "Worker memory usage",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "axisCenteredZero": false,
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "opacity",
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {"group": "A", "mode": "none"},
            "thresholdsStyle": {"mode": "line"}
          },
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 536870912}]},
          "unit": "bytes"
        },
        "overrides": []
      },
      "gridPos": {"h": 7, "w": 12, "x": 0, "y": 22},
      "id": 10,
      "options": {
        "legend": {"calcs": ["lastNotNull", "max"], "displayMode": "table", "placement": "right", "showLegend": true},
        "tooltip": {"mode": "multi", "sort": "desc"}
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "process_resident_memory_bytes{job=~\"celery.*\"}",
          "legendFormat": "{{job}}",
          "refId": "A"
        }
      ],
      "title": "üß† Worker Memory",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "Worker CPU usage",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {
            "axisCenteredZero": false,
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "opacity",
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {"group": "A", "mode": "none"}
          },
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]},
          "unit": "percentunit"
        },
        "overrides": []
      },
      "gridPos": {"h": 7, "w": 12, "x": 12, "y": 22},
      "id": 11,
      "options": {
        "legend": {"calcs": ["lastNotNull", "max"], "displayMode": "table", "placement": "right", "showLegend": true},
        "tooltip": {"mode": "multi", "sort": "desc"}
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "rate(process_cpu_seconds_total{job=~\"celery.*\"}[1m])",
          "legendFormat": "{{job}}",
          "refId": "A"
        }
      ],
      "title": "üíª Worker CPU",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 29},
      "id": 103,
      "panels": [],
      "title": "üìã System Stats",
      "type": "row"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "Total trades executed successfully",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "fixed", "fixedColor": "green"},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]},
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {"h": 6, "w": 6, "x": 0, "y": 30},
      "id": 12,
      "options": {
        "colorMode": "background_solid",
        "graphMode": "area",
        "justifyMode": "center",
        "orientation": "vertical",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showPercentChange": false,
        "textMode": "value",
        "wideLayout": true
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "sum(celery_task_succeeded_total{name=~\"trading.*|pipeline.trade_execution.*\"}) or vector(0)",
          "legendFormat": "__auto",
          "refId": "A"
        }
      ],
      "title": "‚úÖ Trades Succeeded",
      "type": "stat"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "Total trades that failed",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "fixed", "fixedColor": "red"},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "red", "value": null}]},
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {"h": 6, "w": 6, "x": 6, "y": 30},
      "id": 13,
      "options": {
        "colorMode": "background_solid",
        "graphMode": "area",
        "justifyMode": "center",
        "orientation": "vertical",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showPercentChange": false,
        "textMode": "value",
        "wideLayout": true
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "sum(celery_task_failed_total{name=~\"trading.*|pipeline.trade_execution.*\"}) or vector(0)",
          "legendFormat": "__auto",
          "refId": "A"
        }
      ],
      "title": "‚ùå Trades Failed",
      "type": "stat"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "Number of active Celery workers",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "fixed", "fixedColor": "blue"},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "blue", "value": null}]},
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {"h": 6, "w": 6, "x": 12, "y": 30},
      "id": 14,
      "options": {
        "colorMode": "background_solid",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "vertical",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showPercentChange": false,
        "textMode": "value",
        "wideLayout": true
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "sum(celery_worker_up) or vector(0)",
          "legendFormat": "__auto",
          "refId": "A"
        }
      ],
      "title": "üë∑ Workers Online",
      "type": "stat"
    },
    {
      "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
      "description": "Currently executing tasks",
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "fixed", "fixedColor": "orange"},
          "mappings": [],
          "thresholds": {"mode": "absolute", "steps": [{"color": "orange", "value": null}]},
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {"h": 6, "w": 6, "x": 18, "y": 30},
      "id": 15,
      "options": {
        "colorMode": "background_solid",
        "graphMode": "area",
        "justifyMode": "center",
        "orientation": "vertical",
        "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false},
        "showPercentChange": false,
        "textMode": "value",
        "wideLayout": true
      },
      "targets": [
        {
          "datasource": {"type": "prometheus", "uid": "PBFA97CFB590B2093"},
          "expr": "sum(celery_worker_tasks_active) or vector(0)",
          "legendFormat": "__auto",
          "refId": "A"
        }
      ],
      "title": "‚ö° Active Tasks",
      "type": "stat"
    }
  ],
  "refresh": "10s",
  "schemaVersion": 38,
  "style": "dark",
  "tags": ["trading", "kpis", "business"],
  "templating": {"list": []},
  "time": {"from": "now-1h", "to": "now"},
  "timepicker": {},
  "timezone": "browser",
  "title": "Trading System KPIs",
  "uid": "trading-kpis",
  "version": 1
}
